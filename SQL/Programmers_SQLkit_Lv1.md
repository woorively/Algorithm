# SQL Lv.1

### 기초

```sql
SELECT [ALL|DISTINCT] 열_리스트
FROM 테이블_리스트
[WHERE 조건]
[GROUP BY 열_리스트]
[HAVING 조건]
[ORDER BY 열_리스트 [ASC|DESC]];
```

- **NVL()**
만약 null 값을 다르게 지정하여 출력하고 싶은 경우

```sql
SELECT PT_NAME, 
	PT_NO, 
	GEND_CD, 
	AGE, 
	nvl(TLNO, 'NONE') as TLNO
FROM PATIENT
WHERE AGE <= 12 and GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME;
```

- **IS NULL**

```sql
SELECT WAREHOUSE_ID,
	WAREHOUSE_NAME,
	ADDRESS,
	CASE WHEN FREEZER_YN IS NULL THEN 'N'ELSE FREEZER_YN END AS FREEZER_YN
FROM FOOD_WAREHOUSE
WHERE ADDRESS LIKE '경기도%'
ORDER BY WAREHOUSE_ID
```

- **TO_CHAR()**
숫자, 날짜 등의 값을 문자열로 변환하는 함수

```sql
-- 예제1
SELECT DR_NAME, 
	DR_ID, 
	MCDP_CD, 
	TO_CHAR(HIRE_YMD,'YYYY-MM-DD') as HIRE_YMD
FROM DOCTOR
WHERE MCDP_CD = 'CS' or MCDP_CD = 'GS'
order by HIRE_YMD DESC, DR_NAME;

-- 예제2
SELECT BOOK_ID, 
	TO_CHAR(PUBLISHED_DATE, 'YYYY-MM-DD') as PUBLISHED_DATE
FROM BOOK
WHERE TO_CHAR(PUBLISHED_DATE, 'YYYY') = '2021' and CATEGORY = '인문'
ORDER BY 2;
```

- **복수 테이블 사용**

```sql
-- 예제1
SELECT F.FLAVOR
FROM FIRST_HALF F, ICECREAM_INFO I
WHERE F.FLAVOR = I.FLAVOR and 
	F.TOTAL_ORDER > 3000 and 
	I.INGREDIENT_TYPE = 'fruit_based'
order by F.TOTAL_ORDER desc;

-- 예제2
SELECT B.TITLE, 
	B.BOARD_ID, 
	R.REPLY_ID, 
	R.WRITER_ID, 
	R.CONTENTS, 
	TO_CHAR(R.CREATED_DATE, 'YYYY-MM-DD') as CREATED_DATE
FROM USED_GOODS_BOARD B, USED_GOODS_REPLY R
WHERE B.BOARD_ID = R.BOARD_ID and 
	TO_CHAR(B.CREATED_DATE, 'YYYY-MM') = '2022-10'
ORDER BY R.CREATED_DATE, B.TITLE;
```

- **~로 시작하는 것의 검색**

```sql
SELECT FACTORY_ID, FACTORY_NAME, ADDRESS
FROM FOOD_FACTORY
WHERE ADDRESS LIKE '강원도%'
order by FACTORY_ID;

-- 만일, LIKE '강원도_'이면? 강원도로 시작하는 4글자 스트링
-- 만일, LIKE '%강원도_'이면? 끝에서 두번째에 '강원도'라는 글자가 있는 스트링
-- 만일, LIKE '%강원도%'이면? 강원도를 포함하는 스트링
```

- **AVG()**, **ROUND()**

```sql
SELECT round(avg(DAILY_FEE), 0) AVERAGE_FEE
FROM CAR_RENTAL_COMPANY_CAR
WHERE CAR_TYPE = 'SUV';
```

- **BETWEEN**, **COUNT()**

```sql
-- 예제1
SELECT COUNT(*) as USERS
FROM USER_INFO
WHERE TO_CHAR(JOINED, 'YYYY') = '2021' and 
	(AGE BETWEEN 20 AND 29);

-- 예제2
SELECT COUNT(*) as USERS
FROM USER_INFO
WHERE AGE IS NULL;
```

- **최댓값/최솟값**

```sql
-- 예제1
SELECT NAME
FROM ANIMAL_INS
WHERE DATETIME = (SELECT MIN(DATETIME) FROM ANIMAL_INS);

-- 예제2
SELECT MAX(DATETIME)
FROM ANIMAL_INS;
```

- **제외 쿼리**

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION <> 'Aged'
ORDER BY ANIMAL_ID;

SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION != 'Aged'
ORDER BY ANIMAL_ID;
```

- **NULL이 아닌 경우**

```sql
SELECT MEMBER_ID, 
	MEMBER_NAME, 
	GENDER, 
	TO_CHAR(DATE_OF_BIRTH, 'YYYY-MM-DD') as DATE_OF_BIRTH
FROM MEMBER_PROFILE
WHERE GENDER = 'W' and 
	TO_CHAR(DATE_OF_BIRTH, 'MM') = '03' and 
	TLNO IS NOT NULL
ORDER BY 1;
```

- **CASE WHEN ~ THEN ~ ELSE ~ END**

```sql
SELECT HISTORY_ID, 
    CAR_ID, 
    TO_CHAR(START_DATE, 'YYYY-MM-DD'), 
    TO_CHAR(END_DATE, 'YYYY-MM-DD'), 
    CASE WHEN END_DATE-START_DATE+1 >= 30 
            THEN '장기 대여' 
        ELSE '단기 대여' END as RENT_TYPE
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
WHERE TO_CHAR(START_DATE, 'YYYYMM') = '202209'
ORDER BY 1 desc;
```